<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONI Threat Matrix | Neural Threat Framework</title>
    <style>
        :root {
            --oni-dark: #0a0e17;
            --oni-darker: #060912;
            --oni-blue: #00d4ff;
            --oni-purple: #8b5cf6;
            --oni-pink: #ec4899;
            --oni-green: #10b981;
            --oni-yellow: #f59e0b;
            --oni-red: #ef4444;
            --oni-orange: #f97316;
            --oni-gray: #1e293b;
            --oni-light: #e2e8f0;
            --oni-cyan: #06b6d4;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--oni-dark);
            color: var(--oni-light);
            min-height: 100vh;
            overflow-x: auto;
        }

        /* Header */
        .header {
            padding: 1.5rem 2rem;
            background: var(--oni-darker);
            border-bottom: 1px solid var(--oni-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--oni-red), var(--oni-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.25rem;
        }

        .header-left p {
            color: #64748b;
            font-size: 0.9rem;
        }

        .header-right {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .filter-select {
            background: var(--oni-gray);
            border: 1px solid #334155;
            color: var(--oni-light);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--oni-blue);
        }

        /* Main Container */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            min-height: calc(100vh - 90px);
        }

        /* Matrix Panel */
        .matrix-panel {
            padding: 1.5rem;
            overflow: auto;
        }

        /* Matrix Grid */
        .matrix-container {
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 900px;
        }

        .matrix-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }

        .tactic-header {
            background: var(--oni-darker);
            padding: 1rem;
            text-align: center;
            border-radius: 8px 8px 0 0;
            border-bottom: 3px solid var(--oni-red);
        }

        .tactic-header h3 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .tactic-header .layer-badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            background: rgba(239, 68, 68, 0.2);
            color: var(--oni-red);
        }

        .matrix-body {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }

        .tactic-column {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .technique-card {
            background: var(--oni-gray);
            padding: 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            min-height: 80px;
        }

        .technique-card:hover {
            background: rgba(239, 68, 68, 0.15);
            border-color: var(--oni-red);
            transform: translateY(-2px);
        }

        .technique-card.selected {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--oni-red);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }

        .technique-card.severity-critical {
            border-left: 3px solid var(--oni-red);
        }

        .technique-card.severity-high {
            border-left: 3px solid var(--oni-orange);
        }

        .technique-card.severity-medium {
            border-left: 3px solid var(--oni-yellow);
        }

        .technique-card.severity-low {
            border-left: 3px solid var(--oni-green);
        }

        .technique-id {
            font-size: 0.65rem;
            color: #64748b;
            font-family: monospace;
            margin-bottom: 0.25rem;
        }

        .technique-name {
            font-size: 0.8rem;
            font-weight: 600;
            line-height: 1.3;
        }

        .technique-layers {
            display: flex;
            gap: 0.25rem;
            margin-top: 0.5rem;
            flex-wrap: wrap;
        }

        .layer-chip {
            font-size: 0.6rem;
            padding: 0.1rem 0.4rem;
            border-radius: 3px;
            font-weight: 600;
        }

        .layer-chip.osi { background: rgba(59, 130, 246, 0.3); color: #60a5fa; }
        .layer-chip.gateway { background: rgba(139, 92, 246, 0.3); color: #a78bfa; }
        .layer-chip.cognitive { background: rgba(236, 72, 153, 0.3); color: #f472b6; }

        /* Detail Panel */
        .detail-panel {
            background: var(--oni-darker);
            border-left: 1px solid var(--oni-gray);
            padding: 1.5rem;
            overflow-y: auto;
        }

        .panel-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #64748b;
            margin-bottom: 1rem;
        }

        .detail-header {
            margin-bottom: 1.5rem;
        }

        .detail-id {
            font-size: 0.8rem;
            font-family: monospace;
            color: var(--oni-red);
            margin-bottom: 0.5rem;
        }

        .detail-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .detail-tactic {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        .detail-section {
            margin-bottom: 1.5rem;
        }

        .detail-section h4 {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .detail-section p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--oni-light);
        }

        .severity-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .severity-badge.critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--oni-red);
        }

        .severity-badge.high {
            background: rgba(249, 115, 22, 0.2);
            color: var(--oni-orange);
        }

        .severity-badge.medium {
            background: rgba(245, 158, 11, 0.2);
            color: var(--oni-yellow);
        }

        .severity-badge.low {
            background: rgba(16, 185, 129, 0.2);
            color: var(--oni-green);
        }

        .layer-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .layer-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--oni-gray);
            border-radius: 8px;
        }

        .layer-number {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .layer-number.osi { background: rgba(59, 130, 246, 0.3); color: #60a5fa; }
        .layer-number.gateway { background: rgba(139, 92, 246, 0.3); color: #a78bfa; }
        .layer-number.cognitive { background: rgba(236, 72, 153, 0.3); color: #f472b6; }

        .layer-info {
            flex: 1;
        }

        .layer-info-name {
            font-size: 0.85rem;
            font-weight: 600;
        }

        .layer-info-domain {
            font-size: 0.75rem;
            color: #64748b;
        }

        .defense-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .defense-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            border-left: 3px solid var(--oni-green);
        }

        .defense-icon {
            font-size: 1.25rem;
        }

        .defense-info h5 {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .defense-info p {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #64748b;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .empty-state h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--oni-light);
        }

        /* Legend */
        .legend {
            display: flex;
            gap: 1.5rem;
            padding: 1rem;
            background: var(--oni-darker);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: #94a3b8;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-color.critical { background: var(--oni-red); }
        .legend-color.high { background: var(--oni-orange); }
        .legend-color.medium { background: var(--oni-yellow); }
        .legend-color.low { background: var(--oni-green); }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            gap: 2rem;
            padding: 1rem 1.5rem;
            background: var(--oni-darker);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--oni-blue);
        }

        .stat-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
        }

        /* Kohno Badge */
        .kohno-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 0.5rem;
        }

        .kohno-badge.alteration {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .kohno-badge.blocking {
            background: rgba(245, 158, 11, 0.2);
            color: var(--oni-yellow);
        }

        .kohno-badge.eavesdropping {
            background: rgba(6, 182, 212, 0.2);
            color: var(--oni-cyan);
        }

        /* References */
        .references {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--oni-gray);
        }

        .reference-item {
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 0.5rem;
        }

        .reference-item a {
            color: var(--oni-blue);
            text-decoration: none;
        }

        .reference-item a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <h1>ONI Threat Matrix</h1>
            <p>Neural Threat Framework â€” 10 Tactics, 29 Techniques mapped to ONI Layers</p>
        </div>
        <div class="header-right">
            <div class="filter-group">
                <span class="filter-label">Severity</span>
                <select class="filter-select" id="severityFilter">
                    <option value="all">All</option>
                    <option value="critical">Critical</option>
                    <option value="high">High</option>
                    <option value="medium">Medium</option>
                </select>
            </div>
            <div class="filter-group">
                <span class="filter-label">Layer</span>
                <select class="filter-select" id="layerFilter">
                    <option value="all">All Layers</option>
                    <option value="7-8">L7-L8 (Gateway)</option>
                    <option value="9-11">L9-L11 (Signal/Transport)</option>
                    <option value="12-14">L12-L14 (Cognitive)</option>
                </select>
            </div>
            <div class="filter-group">
                <span class="filter-label">Kohno Category</span>
                <select class="filter-select" id="kohnoFilter">
                    <option value="all">All</option>
                    <option value="alteration">Alteration (Integrity)</option>
                    <option value="blocking">Blocking (Availability)</option>
                    <option value="eavesdropping">Eavesdropping (Confidentiality)</option>
                </select>
            </div>
        </div>
    </header>

    <!-- Info Box -->
    <div style="padding: 1rem 2rem 0;">
        <div style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(249, 115, 22, 0.1)); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 12px; padding: 1rem 1.25rem;">
            <div style="display: flex; gap: 1rem; align-items: flex-start;">
                <span style="font-size: 1.25rem;">ðŸŽ¯</span>
                <div style="font-size: 0.9rem;">
                    <strong style="color: #ef4444;">What is this?</strong>
                    <span style="color: #94a3b8; margin-left: 0.5rem;">
                        Neural threat framework inspired by MITRE methodology. 10 tactics across the attack lifecycle, 29 techniques mapped to ONI layers. Grounded in BCI security research: Kohno (2009), Martinovic (2012), Bonaci (2015), Bernal (2023), Schroder (2025).
                        <strong style="color: #e2e8f0;">Click any technique</strong> to see details, defenses, and references.
                        <strong style="color: #e2e8f0;">Use filters</strong> above to narrow by severity, layer range, or Kohno category.
                    </span>
                </div>
            </div>
        </div>
    </div>

    <main class="main-container">
        <section class="matrix-panel">
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value">10</div>
                    <div class="stat-label">Tactics</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">29</div>
                    <div class="stat-label">Techniques</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">19</div>
                    <div class="stat-label">Critical</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">8</div>
                    <div class="stat-label">High</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">2</div>
                    <div class="stat-label">Medium</div>
                </div>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color critical"></div>
                    <span>Critical Severity</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color high"></div>
                    <span>High Severity</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color medium"></div>
                    <span>Medium Severity</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color low"></div>
                    <span>Low Severity</span>
                </div>
            </div>

            <div class="matrix-container">
                <div class="matrix-header" id="matrixHeader"></div>
                <div class="matrix-body" id="matrixBody"></div>
            </div>
        </section>

        <aside class="detail-panel">
            <div class="panel-title">Technique Details</div>
            <div id="detailContent">
                <div class="empty-state">
                    <div class="empty-state-icon">&#128269;</div>
                    <h3>Select a Technique</h3>
                    <p>Click on any technique in the matrix to view detailed information about the attack vector, affected layers, and defenses.</p>
                </div>
            </div>
        </aside>
    </main>

    <script>
        // ONI Threat Matrix Data
        const tactics = [
            { id: "RECON", name: "Reconnaissance", layers: "L1, L7-L9", description: "Gather information for attack planning â€” signal profiling, neural topology scanning" },
            { id: "ACCESS", name: "Initial Access", layers: "L1-L2, L5, L7-L9", description: "Gain entry to the BCI system" },
            { id: "EXEC", name: "Execution", layers: "L9-L11, L13", description: "Run malicious neural signals or commands" },
            { id: "PERSIST", name: "Persistence", layers: "L1, L8, L10-L11, L14", description: "Maintain long-term access â€” exploits brain plasticity" },
            { id: "PRIVESC", name: "Privilege Escalation", layers: "L7-L8", description: "Escalate from app-level to firmware-level control (Schroder et al., 2025)" },
            { id: "EVADE", name: "Defense Evasion", layers: "L3, L6, L8-L10, L12, L14", description: "Avoid detection â€” coherence spoofing, neural spoofing, cognitive state forgery" },
            { id: "CRED", name: "Credential Access", layers: "L5, L12, L14", description: "Steal neural credentials â€” brainprint theft, P300 interrogation (Martinovic et al., 2012)" },
            { id: "COLLECT", name: "Collection", layers: "L3, L7, L10-L14", description: "Extract neural data â€” brain spyware, thought decoding, memory interception" },
            { id: "LATERAL", name: "Lateral Movement", layers: "L8, L11, L13", description: "Move between neural pathways or implants â€” neural sinkhole, pathway hijack" },
            { id: "IMPACT", name: "Impact", layers: "L4, L9-L14", description: "Cause harm â€” flooding, jamming, identity erosion, agency manipulation" }
        ];

        const techniques = {
            RECON: [
                {
                    id: "RECON-01",
                    name: "Signal Profiling",
                    description: "Passive monitoring of neural signal patterns to identify user-specific characteristics, timing patterns, and potential vulnerabilities.",
                    severity: "medium",
                    layers: [7, 8],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Signal Encryption", description: "Encrypt neural data in transit" },
                        { name: "Traffic Analysis Detection", description: "Detect unusual monitoring patterns" }
                    ]
                },
                {
                    id: "RECON-02",
                    name: "Side-Channel Analysis",
                    description: "Extract information through power consumption, timing variations, or electromagnetic emissions from BCI hardware.",
                    severity: "high",
                    layers: [8, 9],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Constant-time Operations", description: "Prevent timing-based leakage" },
                        { name: "Power Filtering", description: "Mask power consumption patterns" }
                    ]
                },
                {
                    id: "RECON-03",
                    name: "Network Mapping",
                    description: "Discover BCI node topology, identify connected devices, and map communication pathways.",
                    severity: "medium",
                    layers: [7],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Network Segmentation", description: "Isolate BCI components" },
                        { name: "Topology Obfuscation", description: "Hide network structure" }
                    ]
                },
                {
                    id: "RECON-04",
                    name: "Neural Topology Scanning",
                    description: "Systematic probe stimulation to map neural signal processing pathways, electrode coverage, and exploitable bottlenecks (Bernal et al., 2023: 'Neural Scanning').",
                    severity: "high",
                    layers: [9],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Stimulation Monitoring", description: "Detect unauthorized probe patterns" },
                        { name: "Response Masking", description: "Add noise to prevent topology mapping" }
                    ]
                }
            ],
            ACCESS: [
                {
                    id: "ACCESS-01",
                    name: "Electrode Compromise",
                    description: "Physical access to implanted electrodes through surgical insertion, hardware tampering, or supply chain attacks.",
                    severity: "critical",
                    layers: [8],
                    kohno: "alteration",
                    defenses: [
                        { name: "Tamper Detection", description: "Hardware integrity monitoring" },
                        { name: "Supply Chain Verification", description: "Authenticate components" }
                    ]
                },
                {
                    id: "ACCESS-02",
                    name: "RF Exploitation",
                    description: "Exploit wireless communication protocols (Bluetooth, proprietary RF) to gain unauthorized access to BCI systems.",
                    severity: "critical",
                    layers: [8, 9],
                    kohno: "alteration",
                    defenses: [
                        { name: "Protocol Hardening", description: "Secure wireless protocols" },
                        { name: "Range Limiting", description: "Reduce wireless range" }
                    ]
                },
                {
                    id: "ACCESS-03",
                    name: "Firmware Backdoor",
                    description: "Compromise BCI firmware through malicious updates, exploited vulnerabilities, or pre-installed backdoors.",
                    severity: "critical",
                    layers: [9],
                    kohno: "alteration",
                    defenses: [
                        { name: "Code Signing", description: "Verify firmware authenticity" },
                        { name: "Secure Boot", description: "Boot chain verification" }
                    ]
                }
            ],
            EXEC: [
                {
                    id: "EXEC-01",
                    name: "Signal Injection",
                    description: "Inject crafted neural signals to manipulate brain activity, trigger unintended actions, or disrupt normal function.",
                    severity: "critical",
                    layers: [9, 10, 11],
                    kohno: "alteration",
                    defenses: [
                        { name: "Coherence Validation", description: "Verify signal coherence (Câ‚›)" },
                        { name: "Rate Limiting", description: "Limit stimulation frequency" }
                    ]
                },
                {
                    id: "EXEC-02",
                    name: "Protocol Manipulation",
                    description: "Exploit weaknesses in neural communication protocols to execute unauthorized commands.",
                    severity: "high",
                    layers: [9, 10],
                    kohno: "alteration",
                    defenses: [
                        { name: "Protocol Authentication", description: "Authenticate all commands" },
                        { name: "Sequence Validation", description: "Verify command sequences" }
                    ]
                },
                {
                    id: "EXEC-03",
                    name: "Command Hijacking",
                    description: "Intercept and modify motor commands in transit, potentially causing involuntary movements.",
                    severity: "critical",
                    layers: [10, 11],
                    kohno: "alteration",
                    defenses: [
                        { name: "Command Integrity", description: "Cryptographic command verification" },
                        { name: "Intent Verification", description: "Cross-check with user intent" }
                    ]
                }
            ],
            PERSIST: [
                {
                    id: "PERSIST-01",
                    name: "Pattern Lock",
                    description: "Embed recurring attack patterns that survive system reboots by exploiting neural plasticity.",
                    severity: "high",
                    layers: [10, 11],
                    kohno: "alteration",
                    defenses: [
                        { name: "Pattern Detection", description: "Identify anomalous patterns" },
                        { name: "Baseline Monitoring", description: "Track neural baseline drift" }
                    ]
                },
                {
                    id: "PERSIST-02",
                    name: "Memory Implant",
                    description: "Create persistent modifications to neural pathways through repeated stimulation patterns.",
                    severity: "critical",
                    layers: [11],
                    kohno: "alteration",
                    defenses: [
                        { name: "Plasticity Monitoring", description: "Track synaptic changes" },
                        { name: "Reversal Protocols", description: "Counter-stimulation procedures" }
                    ]
                }
            ],
            EVADE: [
                {
                    id: "EVADE-01",
                    name: "Coherence Mimicry",
                    description: "Craft attack signals that match legitimate coherence patterns to bypass NSAM detection.",
                    severity: "high",
                    layers: [8, 9],
                    kohno: "alteration",
                    defenses: [
                        { name: "Multi-factor Validation", description: "Combine multiple metrics" },
                        { name: "Behavioral Analysis", description: "Detect anomalous behavior" }
                    ]
                },
                {
                    id: "EVADE-02",
                    name: "Gradual Drift",
                    description: "Make slow, incremental changes that stay below detection thresholds over extended periods.",
                    severity: "high",
                    layers: [9, 10],
                    kohno: "alteration",
                    defenses: [
                        { name: "Long-term Baseline", description: "Track cumulative changes" },
                        { name: "Drift Alerts", description: "Alert on sustained drift" }
                    ]
                }
            ],
            PRIVESC: [
                {
                    id: "PRIVESC-01",
                    name: "Firmware Privilege Escalation",
                    description: "Escalate from app-level API access to firmware-level device control, gaining read-write access to the neural interface (Schroder et al., 2025).",
                    severity: "critical",
                    layers: [7, 8],
                    kohno: "alteration",
                    defenses: [
                        { name: "Code Signing", description: "Verify firmware authenticity" },
                        { name: "Privilege Separation", description: "Isolate app and firmware contexts" }
                    ]
                }
            ],
            CRED: [
                {
                    id: "CRED-01",
                    name: "P300 Interrogation",
                    description: "Present subliminal stimuli to elicit involuntary P300 event-related potentials, extracting whether the user recognizes specific items â€” PINs, faces, locations (Martinovic et al., 2012).",
                    severity: "critical",
                    layers: [12, 13],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "BCI Anonymizer", description: "Filter P300 components before app access (Bonaci et al., 2015)" },
                        { name: "Stimulus Auditing", description: "Monitor and restrict stimuli presented to user" }
                    ]
                },
                {
                    id: "CRED-02",
                    name: "Brainprint Theft",
                    description: "Extract the user's unique neural authentication signature to impersonate them to BCI systems or forge their neural identity (Armstrong et al., 2015).",
                    severity: "critical",
                    layers: [14],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Cancellable Biometrics", description: "Revocable neural templates that can be regenerated" },
                        { name: "Multi-modal Auth", description: "Combine brainprint with other factors" }
                    ]
                },
                {
                    id: "CRED-03",
                    name: "Session Token Hijacking",
                    description: "Take over authenticated BCI sessions by capturing or replaying neural session tokens to gain unauthorized access.",
                    severity: "high",
                    layers: [5],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Token Rotation", description: "Frequently rotate session tokens" },
                        { name: "Binding", description: "Bind tokens to neural signature" }
                    ]
                }
            ],
            LATERAL: [
                {
                    id: "LATERAL-01",
                    name: "Neural Pathway Hijack",
                    description: "Redirect cognitive signals through unintended neural pathways for interception or modification â€” cross-region lateral movement.",
                    severity: "high",
                    layers: [11],
                    kohno: "alteration",
                    defenses: [
                        { name: "Pathway Monitoring", description: "Track expected vs actual signal routes" },
                        { name: "Circuit Isolation", description: "Restrict cross-region signal flow" }
                    ]
                },
                {
                    id: "LATERAL-02",
                    name: "Neural Sinkhole",
                    description: "Attract semantic processing signals to a compromised neural region, then modify or drop them before forwarding (Bernal et al., 2023).",
                    severity: "critical",
                    layers: [13],
                    kohno: "alteration",
                    defenses: [
                        { name: "Signal Integrity Checks", description: "Verify content at destination matches source" },
                        { name: "Redundant Pathways", description: "Send via multiple routes for comparison" }
                    ]
                },
                {
                    id: "LATERAL-03",
                    name: "Bidirectional Channel Exploit",
                    description: "Exploit read/write neural interface capabilities to pivot from data collection to active stimulation â€” full bidirectional compromise.",
                    severity: "critical",
                    layers: [8],
                    kohno: "alteration",
                    defenses: [
                        { name: "Unidirectional Enforcement", description: "Hardware-enforced read-only mode when stimulation not prescribed" },
                        { name: "Command Authorization", description: "Require explicit authorization for write operations" }
                    ]
                }
            ],
            COLLECT: [
                {
                    id: "COLLECT-01",
                    name: "ERP Harvesting",
                    description: "Extract event-related potentials (P300, N170, N400) to infer private information about the user.",
                    severity: "critical",
                    layers: [12, 13],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "ERP Filtering", description: "Block sensitive ERP components" },
                        { name: "BCI Anonymizer", description: "Privacy-preserving signal processing" }
                    ]
                },
                {
                    id: "COLLECT-02",
                    name: "Cognitive Capture",
                    description: "Record and analyze cognitive state patterns including attention, emotion, and decision-making processes.",
                    severity: "critical",
                    layers: [12, 13, 14],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "State Obfuscation", description: "Add noise to cognitive signals" },
                        { name: "Access Control", description: "Strict data access policies" }
                    ]
                },
                {
                    id: "COLLECT-03",
                    name: "Memory Extraction",
                    description: "Read memory-related signals from hippocampus to extract stored information or experiences.",
                    severity: "critical",
                    layers: [11, 12],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Memory Encryption", description: "Encrypt memory-related signals" },
                        { name: "Query Detection", description: "Detect memory probing patterns" }
                    ]
                },
                {
                    id: "COLLECT-04",
                    name: "Brain Spyware",
                    description: "Malicious BCI application with unrestricted SDK access to raw brainwave signals, silently exfiltrating neural data (Bonaci et al., 2015: 'App Stores for the Brain').",
                    severity: "critical",
                    layers: [7],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "BCI Anonymizer", description: "Filter raw signals before app access (Bonaci et al., 2015)" },
                        { name: "SDK Sandboxing", description: "Restrict API access to decoded commands only" }
                    ]
                },
                {
                    id: "COLLECT-05",
                    name: "Thought Decoding",
                    description: "Decode semantic representations from neural activity to extract intended meanings, plans, and inner speech â€” the deepest form of neural privacy violation.",
                    severity: "critical",
                    layers: [13, 14],
                    kohno: "eavesdropping",
                    defenses: [
                        { name: "Semantic Obfuscation", description: "Inject noise at semantic processing layer" },
                        { name: "Consent Verification", description: "Require explicit consent for semantic-level data access" }
                    ]
                }
            ],
            IMPACT: [
                {
                    id: "IMPACT-01",
                    name: "Neural DoS",
                    description: "Overwhelm neural pathways with excessive stimulation, causing temporary cognitive impairment.",
                    severity: "critical",
                    layers: [11, 12],
                    kohno: "blocking",
                    defenses: [
                        { name: "Rate Limiting", description: "Enforce stimulation limits" },
                        { name: "Automatic Shutoff", description: "Emergency signal cutoff" }
                    ]
                },
                {
                    id: "IMPACT-02",
                    name: "Motor Hijacking",
                    description: "Force involuntary movements by injecting motor commands, potentially causing physical harm.",
                    severity: "critical",
                    layers: [11, 13],
                    kohno: "alteration",
                    defenses: [
                        { name: "Intent Verification", description: "Verify motor intent" },
                        { name: "Safety Bounds", description: "Limit movement parameters" }
                    ]
                },
                {
                    id: "IMPACT-03",
                    name: "Identity Erosion",
                    description: "Long-term manipulation of personality, preferences, and self-model through persistent subtle stimulation.",
                    severity: "critical",
                    layers: [13, 14],
                    kohno: "alteration",
                    defenses: [
                        { name: "Identity Baseline", description: "Track personality metrics" },
                        { name: "Drift Detection", description: "Alert on identity changes" }
                    ]
                }
            ]
        };

        const layerNames = {
            1: { name: "Physical", domain: "OSI" },
            2: { name: "Data Link", domain: "OSI" },
            3: { name: "Network", domain: "OSI" },
            4: { name: "Transport", domain: "OSI" },
            5: { name: "Session", domain: "OSI" },
            6: { name: "Presentation", domain: "OSI" },
            7: { name: "Application", domain: "OSI" },
            8: { name: "Neural Gateway", domain: "Gateway" },
            9: { name: "Signal Processing", domain: "Neural" },
            10: { name: "Protocol", domain: "Neural" },
            11: { name: "Cognitive Transport", domain: "Cognitive" },
            12: { name: "Cognitive Session", domain: "Cognitive" },
            13: { name: "Semantic", domain: "Cognitive" },
            14: { name: "Identity & Ethics", domain: "Cognitive" }
        };

        let selectedTechnique = null;

        // Render matrix
        function renderMatrix() {
            const headerEl = document.getElementById('matrixHeader');
            const bodyEl = document.getElementById('matrixBody');

            // Render headers
            headerEl.innerHTML = tactics.map(t => `
                <div class="tactic-header">
                    <h3>${t.name}</h3>
                    <span class="layer-badge">${t.layers}</span>
                </div>
            `).join('');

            // Render body
            bodyEl.innerHTML = tactics.map(t => `
                <div class="tactic-column" data-tactic="${t.id}">
                    ${techniques[t.id].map(tech => renderTechniqueCard(tech)).join('')}
                </div>
            `).join('');

            // Add click handlers
            document.querySelectorAll('.technique-card').forEach(card => {
                card.addEventListener('click', () => selectTechnique(card.dataset.id));
            });
        }

        function renderTechniqueCard(tech) {
            const layerChips = tech.layers.map(l => {
                const domain = layerNames[l].domain.toLowerCase();
                const chipClass = domain === 'osi' ? 'osi' : domain === 'gateway' ? 'gateway' : 'cognitive';
                return `<span class="layer-chip ${chipClass}">L${l}</span>`;
            }).join('');

            return `
                <div class="technique-card severity-${tech.severity}" data-id="${tech.id}" data-severity="${tech.severity}" data-layers="${tech.layers.join(',')}" data-kohno="${tech.kohno}">
                    <div class="technique-id">${tech.id}</div>
                    <div class="technique-name">${tech.name}</div>
                    <div class="technique-layers">${layerChips}</div>
                </div>
            `;
        }

        function selectTechnique(id) {
            // Find technique
            let technique = null;
            let tacticName = '';
            for (const [tacticId, techs] of Object.entries(techniques)) {
                const found = techs.find(t => t.id === id);
                if (found) {
                    technique = found;
                    tacticName = tactics.find(t => t.id === tacticId).name;
                    break;
                }
            }

            if (!technique) return;

            selectedTechnique = id;

            // Update selection visual
            document.querySelectorAll('.technique-card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`[data-id="${id}"]`).classList.add('selected');

            // Render details
            renderDetails(technique, tacticName);
        }

        function renderDetails(tech, tacticName) {
            const detailEl = document.getElementById('detailContent');

            const layerItems = tech.layers.map(l => {
                const layer = layerNames[l];
                const domainClass = layer.domain.toLowerCase() === 'osi' ? 'osi' :
                                   layer.domain.toLowerCase() === 'gateway' ? 'gateway' : 'cognitive';
                return `
                    <div class="layer-item">
                        <div class="layer-number ${domainClass}">L${l}</div>
                        <div class="layer-info">
                            <div class="layer-info-name">${layer.name}</div>
                            <div class="layer-info-domain">${layer.domain} Domain</div>
                        </div>
                    </div>
                `;
            }).join('');

            const defenseItems = tech.defenses.map(d => `
                <div class="defense-item">
                    <div class="defense-icon">&#128737;</div>
                    <div class="defense-info">
                        <h5>${d.name}</h5>
                        <p>${d.description}</p>
                    </div>
                </div>
            `).join('');

            const kohnoLabels = {
                alteration: 'Alteration (Integrity)',
                blocking: 'Blocking (Availability)',
                eavesdropping: 'Eavesdropping (Confidentiality)'
            };

            detailEl.innerHTML = `
                <div class="detail-header">
                    <div class="detail-id">${tech.id}</div>
                    <div class="detail-name">${tech.name}</div>
                    <div class="detail-tactic">Tactic: ${tacticName}</div>
                    <span class="kohno-badge ${tech.kohno}">${kohnoLabels[tech.kohno]}</span>
                </div>

                <div class="detail-section">
                    <h4>Description</h4>
                    <p>${tech.description}</p>
                </div>

                <div class="detail-section">
                    <h4>Severity</h4>
                    <div class="severity-badge ${tech.severity}">
                        <span>${tech.severity === 'critical' ? '&#9888;' : tech.severity === 'high' ? '&#9888;' : '&#9432;'}</span>
                        ${tech.severity.toUpperCase()}
                    </div>
                </div>

                <div class="detail-section">
                    <h4>Target Layers</h4>
                    <div class="layer-list">${layerItems}</div>
                </div>

                <div class="detail-section">
                    <h4>Defenses</h4>
                    <div class="defense-list">${defenseItems}</div>
                </div>

                <div class="references">
                    <div class="reference-item">
                        <strong>Kohno Taxonomy:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/19569895/" target="_blank">Denning et al. (2009)</a>
                    </div>
                    <div class="reference-item">
                        <strong>Inspired by:</strong> <a href="https://attack.mitre.org/" target="_blank">MITRE Threat Framework</a>
                    </div>
                </div>
            `;
        }

        // Filtering
        function applyFilters() {
            const severity = document.getElementById('severityFilter').value;
            const layer = document.getElementById('layerFilter').value;
            const kohno = document.getElementById('kohnoFilter').value;

            document.querySelectorAll('.technique-card').forEach(card => {
                let show = true;

                if (severity !== 'all' && card.dataset.severity !== severity) {
                    show = false;
                }

                if (layer !== 'all') {
                    const cardLayers = card.dataset.layers.split(',').map(Number);
                    const [min, max] = layer.split('-').map(Number);
                    const hasLayer = cardLayers.some(l => l >= min && l <= max);
                    if (!hasLayer) show = false;
                }

                if (kohno !== 'all' && card.dataset.kohno !== kohno) {
                    show = false;
                }

                card.style.display = show ? 'block' : 'none';
            });
        }

        // Event listeners
        document.getElementById('severityFilter').addEventListener('change', applyFilters);
        document.getElementById('layerFilter').addEventListener('change', applyFilters);
        document.getElementById('kohnoFilter').addEventListener('change', applyFilters);

        // Initialize
        renderMatrix();
    </script>
</body>
</html>
